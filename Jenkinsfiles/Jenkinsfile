pipeline {
  agent {
    node { 
      label 'win'
      customWorkspace 'PR_Checks'
    }
  }

  def stagePrefix = JOB_BASE_NAME.split('-')[2];

  stages {
    stage("$stagePrefix Checkout"){
      steps {
        checkout scm
      }
    }
    stage("$stagePrefix Unit Test") {
      steps {
        bat "\"C:\\Program Files\\Unity\\Hub\\Editor\\2020.3.9f1\\Editor\\Unity.exe\" -runTests -batchmode -testResults $WORKSPACE\\results.xml -logfile - -quit"
      }
    }
    stage("$stagePrefix Other Test") {
      steps {
        echo "Hello World!"
      }
    }
    stage("$stagePrefix Random Failing Test") {
      steps {
        error 'Fail'
      }
    }
  }
}